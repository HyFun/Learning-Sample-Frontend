<!--
 * @Author       : HyFun
 * @Date         : 2021-02-04 13:48:28
 * @Description  : 合并两个对象
 * @LastEditors  : HyFun
 * @LastEditTime : 2021-02-04 15:48:32
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>合并两个对象</title>
  </head>
  <body></body>
</html>

<script>
  /**
   * 判断obj对象是否有属性key
   */
  function hasOwn(obj, key) {
    return Object.prototype.hasOwnProperty.call(obj, key);
  }

  /**
   *  将value赋值到to中没有的key上
   */
  function set(target, key, value) {
    // 如果目标是一个数组
    if (Array.isArray(target)) {
      target.splice(key, 1, value);
      return value;
    }
    // 如果target有属性key 且 Object原型上没有
    // 可以直接设置值
    // if (key in target && !(key in Object.prototype)) {
    //   //
    //   target[key] = value;
    //   return value;
    // }
    if (!(key in Object.prototype)) {
      target[key] = value;
      return value;
    }
    return value;
  }

  /**
   *  判断是否是一个对象
   */
  function isObejct(obj) {
    return !!obj && typeof obj === "object";
  }

  function mergeData(to, from) {
    if (!from) return to;
    var key, toVal, fromVal;
    var keys = Object.keys(from);
    keys.forEach((item) => {
      key = item;
      toVal = to[key];
      fromVal = from[key];
      // 判断对象自身属性是否拥有属性key
      if (!hasOwn(to, key)) {
        // 如果没有，则设置
        set(to, key, fromVal);
      } else if (toVal !== fromVal && isObejct(toVal) && isObejct(fromVal)) {
        mergeData(toVal, fromVal);
      }
    });
  }

  // 数组 <- 数组
  //   {
  //     const a = [1, 2, 3];
  //     const b = [4, 5, 6, 7, 8];
  //     mergeData(a, b);
  //     console.log(a); // [1 2 3 7 8]
  //   }

  // 数组 <- 对象
  //   {
  //       const a = [1,2,3]
  //       const b = {name: '张三'}
  //       mergeData(a,b)
  //       console.log(a); // ['张三',2,3]
  //   }

  // 对象 <- 数组
//   {
//     const a = { name: "张三" };
//     const b = [1, 2, 3];
//     mergeData(a, b);
//     console.log(a); // {0: 1, 1: 2, 2: 3, name: "张三"}
//   }


    // 对象 <- 对象
    {
        const a = {name: '张三'}
        const b = {name: '李四', age: 20}
        mergeData(a,b)
        console.log(a); // {name: "张三", age: 20}
    }
</script>
